(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{597:function(t,s,n){t.exports=n.p+"assets/img/2018_12_08_M3OBbekLBh.826ce7bd.gif"},598:function(t,s,n){t.exports=n.p+"assets/img/2018_12_08_j6oBFSpwW5.776f7077.gif"},849:function(t,s,n){"use strict";n.r(s);var a=n(13),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("blockquote",[a("p",[t._v("ä»Šå¤©æˆ‘ä»¬æ¥è¯´ä¸€è¯´å‰åç«¯åˆ†ç¦»ä¸­çš„æ— ç—›åˆ·æ–°æœºåˆ¶ï¼Œåœ¨æ‰‹æœº app ä¸­åº”è¯¥ç»å¸¸ç”¨åˆ°ï¼Œ")]),t._v(" "),a("p",[t._v("å¤§å®¶éƒ½çŸ¥é“åœ¨å‰åç«¯æ˜¯ä»¥ token çš„å½¢å¼äº¤äº’ï¼Œæ—¢ç„¶æ˜¯ tokenï¼Œé‚£ä¹ˆè‚¯å®šæœ‰å®ƒçš„è¿‡æœŸæ—¶é—´ï¼Œæ²¡æœ‰ä¸€ä¸ª token æ˜¯æ°¸ä¹…çš„ï¼Œæ°¸ä¹…çš„ token å°±ç›¸å½“äºä¸€ä¸²æ°¸ä¹…çš„å¯†ç ï¼Œæ˜¯ä¸å®‰å…¨çš„ï¼Œ")]),t._v(" "),a("p",[t._v("é‚£ä¹ˆæ—¢ç„¶æœ‰åˆ·æ–°æ—¶é—´ï¼Œé—®é¢˜å°±æ¥äº†")])]),t._v(" "),a("ul",[a("li",[t._v("å‰åç«¯äº¤äº’çš„è¿‡ç¨‹ä¸­ token å¦‚ä½•å­˜å‚¨ï¼Ÿ")]),t._v(" "),a("li",[t._v("token è¿‡æœŸæ—¶ï¼Œå‰ç«¯è¯¥æ€ä¹ˆå¤„ç†")]),t._v(" "),a("li",[t._v("å½“ç”¨æˆ·æ­£åœ¨æ“ä½œæ—¶ï¼Œé‡åˆ° token è¿‡æœŸè¯¥æ€ä¹ˆåŠï¼Ÿç›´æ¥è·³å›ç™»é™†é¡µé¢ï¼ŸğŸ˜…ï¼ˆä½ ç¡®å®šè¿™æ ·ç”¨æˆ·ä¸ä¼šæ‰“æ­»ä½ å—ï¼Œè€å­å¥½ä¸å®¹æ˜“è¡¨å•å¡«å®Œå‡†å¤‡æäº¤ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼‰")])]),t._v(" "),a("h2",{attrs:{id:"token-å¦‚ä½•å­˜å‚¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#token-å¦‚ä½•å­˜å‚¨"}},[t._v("#")]),t._v(" token å¦‚ä½•å­˜å‚¨")]),t._v(" "),a("blockquote",[a("p",[t._v("cookie çš„å¤§å°çº¦ 4kï¼Œå…¼å®¹æ€§åœ¨ ie6 åŠä»¥ä¸Š éƒ½å…¼å®¹ï¼Œåœ¨æµè§ˆå™¨å’ŒæœåŠ¡å™¨é—´æ¥å›ä¼ é€’ï¼Œå› æ­¤å®ƒå¾—åœ¨æœåŠ¡å™¨çš„ç¯å¢ƒä¸‹è¿è¡Œï¼Œè€Œä¸”å¯ä»¥è®¾å®šè¿‡æœŸæ—¶é—´ï¼Œé»˜è®¤çš„è¿‡æœŸæ—¶é—´æ˜¯ session ä¼šè¯ç»“æŸã€‚\nlocalStorage çš„å¤§å°çº¦ 5Mï¼Œå…¼å®¹æ€§åœ¨ ie7 åŠä»¥ä¸Šéƒ½å…¼å®¹ï¼Œæœ‰æµè§ˆå™¨å°±å¯ä»¥ï¼Œä¸éœ€è¦åœ¨æœåŠ¡å™¨çš„ç¯å¢ƒä¸‹è¿è¡Œï¼Œ ä¼šä¸€ç›´å­˜åœ¨ï¼Œé™¤éæ‰‹åŠ¨æ¸…é™¤ ã€‚")])]),t._v(" "),a("p",[t._v("å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œç­”æ¡ˆå¤§è‡´åˆ†ä¸º 2 ç§")]),t._v(" "),a("ol",[a("li",[t._v("å­˜åœ¨ "),a("code",[t._v("cookie")]),t._v(" ä¸­")]),t._v(" "),a("li",[t._v("å­˜åœ¨ "),a("code",[t._v("localStorage")]),t._v(" ä¸­")])]),t._v(" "),a("p",[t._v("æˆ‘è§‰å¾—éƒ½å¯ä»¥ï¼Œä¸¤ç§æˆ‘éƒ½ç”¨ ğŸ˜„")]),t._v(" "),a("h2",{attrs:{id:"token-è¿‡æœŸæ—¶-å‰ç«¯è¯¥æ€ä¹ˆå¤„ç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#token-è¿‡æœŸæ—¶-å‰ç«¯è¯¥æ€ä¹ˆå¤„ç†"}},[t._v("#")]),t._v(" token è¿‡æœŸæ—¶ï¼Œå‰ç«¯è¯¥æ€ä¹ˆå¤„ç†")]),t._v(" "),a("p",[t._v("æ€è·¯ï¼štoken è¿‡æœŸå¤„ç†æ–¹å¼å¤§æ¦‚å°±æ˜¯ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("ç¬¬ä¸€ç§ï¼šè·³å›ç™»é™†é¡µé¢é‡æ–°ç™»é™†")]),t._v(" "),a("li",[t._v("ç¬¬äºŒç§ï¼š"),a("code",[t._v("catch")]),t._v(" 401 ï¼Œç„¶åé‡æ–°è·å– "),a("code",[t._v("token")])])]),t._v(" "),a("p",[t._v("å¯¹äºç¬¬ä¸€ç§ï¼Œå¾ˆç®€å•åœ¨ vue ä¸­æˆ‘ä»¬å¯ä»¥åœ¨ "),a("code",[t._v("axios")]),t._v(" æ‹¦æˆªå™¨ä¸­è¿™æ ·å†™ï¼š")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("interceptors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("response")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯¹å“åº”æ•°æ®åšç‚¹ä»€ä¹ˆ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("401")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            Message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç™»é™†è¿‡æœŸè¯·é‡æ–°ç™»é™†ï¼'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setToken")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'login'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯¹å“åº”é”™è¯¯åšç‚¹ä»€ä¹ˆ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br")])]),a("p",[t._v("å¯¹äºç¬¬äºŒç§ï¼Œå¦‚ä½•é‡æ–°è·å– "),a("code",[t._v("token")]),t._v("ï¼Œè¿™å°±è¦æ¶‰åŠåˆ°åç«¯çš„çŸ¥è¯†äº†")]),t._v(" "),a("h3",{attrs:{id:"æ¥å…ˆè®©æˆ‘è®²ä¸€æ®µåºŸè¯-ğŸ˜…"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ¥å…ˆè®©æˆ‘è®²ä¸€æ®µåºŸè¯-ğŸ˜…"}},[t._v("#")]),t._v(" æ¥å…ˆè®©æˆ‘è®²ä¸€æ®µåºŸè¯ ğŸ˜…")]),t._v(" "),a("blockquote",[a("p",[t._v("ç°ä»£è®¤è¯å’Œ/æˆ–æˆæƒè§£å†³æ–¹æ¡ˆå·²å°†"),a("em",[t._v("ä»¤ç‰Œ")]),t._v("çš„æ¦‚å¿µå¼•å…¥å…¶åè®®ä¸­ã€‚ä»¤ç‰Œæ˜¯ç»è¿‡ç‰¹æ®Šå¤„ç†çš„æ•°æ®ï¼Œå®ƒä»¬å¯ä»¥æä¾›è¶³å¤Ÿçš„ä¿¡æ¯æ¥"),a("strong",[t._v("æˆæƒç”¨æˆ·æ‰§è¡Œæ“ä½œ")]),t._v("ï¼Œæˆ–è€…å…è®¸å®¢æˆ·ç«¯"),a("strong",[t._v("è·å–æœ‰å…³æˆæƒ")]),t._v("è¿‡ç¨‹çš„"),a("strong",[t._v("å…¶ä»–ä¿¡æ¯")]),t._v("ï¼ˆç„¶åå®Œæˆå®ƒï¼‰ã€‚æ¢å¥è¯è¯´ï¼Œä»¤ç‰Œæ˜¯å…è®¸æ‰§è¡Œæˆæƒè¿‡ç¨‹çš„ä¿¡æ¯ã€‚å®¢æˆ·ç«¯ï¼ˆæˆ–æˆæƒæœåŠ¡å™¨ä»¥å¤–çš„ä»»ä½•ä¸€æ–¹ï¼‰æ˜¯å¦å¯è¯»å–æˆ–è§£ææ­¤ä¿¡æ¯æ˜¯ç”±å®ç°å®šä¹‰çš„ã€‚é‡è¦çš„æ˜¯ï¼šå®¢æˆ·ç«¯è·å–æ­¤ä¿¡æ¯ï¼Œç„¶åä½¿ç”¨å®ƒæ¥"),a("strong",[t._v("è®¿é—®èµ„æº")]),t._v("ã€‚JSON Web ä»¤ç‰Œï¼ˆJWTï¼‰"),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc7519",target:"_blank",rel:"noopener noreferrer"}},[t._v("è§„èŒƒ"),a("OutboundLink")],1),t._v(" å®šä¹‰äº†ä¸€ç§å¯ä»¥ç”±å®ç°è¡¨ç¤ºå…¬å…±ä»¤ç‰Œä¿¡æ¯çš„æ–¹å¼ã€‚")])]),t._v(" "),a("blockquote",[a("p",[t._v("JWT å®šä¹‰äº†ä¸€ç§æ–¹å¼ï¼Œå…¶ä¸­å¯ä»¥"),a("strong",[t._v("è¡¨ç¤º")]),t._v("ä¸è®¤è¯/æˆæƒè¿‡ç¨‹æœ‰å…³çš„æŸäº›å…¬å…±ä¿¡æ¯ã€‚é¡¾åæ€ä¹‰ï¼Œæ•°æ®æ ¼å¼æ˜¯"),a("strong",[t._v("JSON")]),t._v("ã€‚JWT å…·æœ‰æŸäº›"),a("strong",[t._v("å¸¸è§å­—æ®µï¼Œ"),a("strong",[t._v("ä¾‹å¦‚ä¸»é¢˜ï¼Œå‘è¡Œè€…ï¼Œåˆ°æœŸæ—¶é—´ç­‰ã€‚å½“ä¸å…¶ä»–è§„èŒƒï¼ˆå¦‚"),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc7515",target:"_blank",rel:"noopener noreferrer"}},[t._v("JSON Web ç­¾åï¼ˆJWSï¼‰"),a("OutboundLink")],1),t._v("å’Œ"),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc7516",target:"_blank",rel:"noopener noreferrer"}},[t._v("JSON Web åŠ å¯†ï¼ˆJWEï¼‰ï¼‰"),a("OutboundLink")],1),t._v("ç»“åˆä½¿ç”¨æ—¶ï¼ŒJWT å˜å¾—éå¸¸æœ‰ç”¨ã€‚è¿™äº›è§„èŒƒä¸ä»…æä¾›äº†æˆæƒä»¤ç‰Œé€šå¸¸æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ï¼Œè€Œä¸”è¿˜æä¾›äº†")]),t._v("éªŒè¯")]),t._v("ä»¤ç‰Œ"),a("strong",[t._v("å†…å®¹")]),t._v("çš„æ–¹æ³•ï¼Œä½¿å…¶ä¸ä¼šè¢«ç¯¡æ”¹ï¼ˆJWSï¼‰å’Œ"),a("strong",[t._v("åŠ å¯†ä¿¡æ¯")]),t._v("ä»¥ä½¿å…¶ä¿æŒ"),a("strong",[t._v("ä¸é€æ˜çš„æ–¹å¼")]),t._v("ç»™å®¢æˆ·ï¼ˆJWEï¼‰ã€‚æ•°æ®æ ¼å¼çš„ç®€å•æ€§ï¼ˆåŠå…¶å®ƒä¼˜ç‚¹ï¼‰å¸®åŠ© JWT æˆä¸ºæœ€å¸¸è§çš„ä»¤ç‰Œç±»å‹ä¹‹ä¸€ã€‚å¦‚æœæ‚¨æœ‰å…´è¶£å­¦ä¹ å¦‚ä½•åœ¨ Web åº”ç”¨ç¨‹åºä¸­å®ç° JWTï¼Œè¯·æŸ¥çœ‹ Ryan Chenkie çš„è¿™ç¯‡ä¼˜ç§€"),a("a",{attrs:{href:"https://auth0.com/blog/2015/09/28/5-steps-to-add-modern-authentication-to-legacy-apps-using-jwts/",target:"_blank",rel:"noopener noreferrer"}},[t._v("æ–‡ç« "),a("OutboundLink")],1),t._v("ã€‚")])]),t._v(" "),a("p",[t._v("å‡ºäºæœ¬æ–‡çš„ç›®çš„ï¼Œæˆ‘ä»¬å°†å…³æ³¨ä¸¤ç§æœ€å¸¸è§çš„ä»¤ç‰Œç±»å‹ï¼š"),a("em",[t._v("è®¿é—®ä»¤ç‰Œ")]),t._v("å’Œ"),a("em",[t._v("åˆ·æ–°ä»¤ç‰Œ")]),t._v("ã€‚")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("è®¿é—®ä»¤ç‰Œ")]),t._v("æºå¸¦å¿…è¦çš„ä¿¡æ¯ä»¥ç›´æ¥è®¿é—®èµ„æºã€‚æ¢å¥è¯è¯´ï¼Œå½“å®¢æˆ·ç«¯å°†è®¿é—®ä»¤ç‰Œä¼ é€’ç»™ç®¡ç†èµ„æºçš„æœåŠ¡å™¨æ—¶ï¼Œè¯¥æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨ä»¤ç‰Œä¸­åŒ…å«çš„ä¿¡æ¯æ¥å†³å®šå®¢æˆ·ç«¯æ˜¯å¦è¢«æˆæƒã€‚è®¿é—®ä»¤ç‰Œé€šå¸¸å…·æœ‰åˆ°æœŸæ—¥æœŸå¹¶ä¸”æ˜¯çŸ­æš‚çš„ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.auth0.com/blog/refresh-token/diag1.png",alt:"è®¿é—®ä»¤ç‰Œ"}})]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("åˆ·æ–°ä»¤ç‰Œ")]),t._v("åŒ…å«è·å–æ–°è®¿é—®ä»¤ç‰Œæ‰€éœ€çš„ä¿¡æ¯ã€‚æ¢å¥è¯è¯´ï¼Œæ¯å½“è®¿é—®ä»¤ç‰Œéœ€è¦è®¿é—®ç‰¹å®šèµ„æºæ—¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæ¥è·å¾—ç”±è®¤è¯æœåŠ¡å™¨å‘å¸ƒçš„æ–°è®¿é—®ä»¤ç‰Œã€‚å¸¸è§ç”¨ä¾‹åŒ…æ‹¬åœ¨æ—§çš„è®¿é—®ä»¤ç‰Œè¿‡æœŸåè·å–æ–°è®¿é—®ä»¤ç‰Œï¼Œæˆ–è€…é¦–æ¬¡è®¿é—®æ–°èµ„æºã€‚åˆ·æ–°ä»¤ç‰Œä¹Ÿå¯ä»¥è¿‡æœŸï¼Œä½†ç›¸å½“é•¿å¯¿ã€‚åˆ·æ–°ä»¤ç‰Œé€šå¸¸å—åˆ°ä¸¥æ ¼çš„å­˜å‚¨è¦æ±‚ï¼Œä»¥ç¡®ä¿å®ƒä»¬ä¸ä¼šæ³„éœ²ã€‚å®ƒä»¬ä¹Ÿå¯ä»¥è¢«æˆæƒæœåŠ¡å™¨åˆ—å…¥é»‘åå•ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.auth0.com/blog/refresh-token/diag2.png",alt:"åˆ·æ–°ä»¤ç‰Œ"}})]),t._v(" "),a("p",[t._v("æ ‡è®°æ˜¯å¦ä¸é€æ˜é€šå¸¸ç”±å®ç°å®šä¹‰ã€‚é€šç”¨å®ç°å…è®¸"),a("strong",[t._v("é’ˆå¯¹è®¿é—®ä»¤ç‰Œ")]),t._v("è¿›è¡Œ"),a("strong",[t._v("ç›´æ¥æˆæƒæ£€æŸ¥")]),t._v("ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“è®¿é—®ä»¤ç‰Œè¢«ä¼ é€’åˆ°ç®¡ç†èµ„æºçš„æœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨å¯ä»¥è¯»å–ä»¤ç‰Œä¸­åŒ…å«çš„ä¿¡æ¯å¹¶è‡ªå·±å†³å®šç”¨æˆ·æ˜¯å¦è¢«æˆæƒï¼ˆä¸éœ€è¦å¯¹æˆæƒæœåŠ¡å™¨è¿›è¡Œæ£€æŸ¥ï¼‰ã€‚è¿™æ˜¯å¿…é¡»ç­¾ç½²ä»¤ç‰Œçš„åŸå› ä¹‹ä¸€ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ JWSï¼‰ã€‚å¦ä¸€æ–¹é¢ï¼Œåˆ·æ–°ä»¤ç‰Œé€šå¸¸éœ€è¦æ£€æŸ¥æˆæƒæœåŠ¡å™¨ã€‚è¿™ç§å¤„ç†æˆæƒæ£€æŸ¥çš„åˆ†å‰²æ–¹å¼å…è®¸ä¸‰ä»¶äº‹ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("æ”¹è¿›äº†æˆæƒæœåŠ¡å™¨çš„è®¿é—®æ¨¡å¼ï¼ˆé™ä½è´Ÿè½½ï¼ŒåŠ å¿«æ£€æŸ¥é€Ÿåº¦ï¼‰")]),t._v(" "),a("li",[t._v("æ³„æ¼è®¿é—®ä»¤ç‰Œçš„è®¿é—®çª—å£è¾ƒçŸ­ï¼ˆè¿™äº›è®¿é—®ä»¤ç‰Œå¾ˆå¿«è¿‡æœŸï¼Œå‡å°‘äº†æ³„éœ²ä»¤ç‰Œå…è®¸è®¿é—®å—ä¿æŠ¤èµ„æºçš„æœºä¼šï¼‰")]),t._v(" "),a("li",[t._v("æ»‘åŠ¨ä¼šè¯ï¼ˆè§ä¸‹æ–‡ï¼‰")])]),t._v(" "),a("p",[t._v("æ»‘åŠ¨ä¼šè¯æ˜¯åœ¨ä¸€æ®µ"),a("strong",[t._v("æ—¶é—´ä¸æ´»åŠ¨")]),t._v("ååˆ°æœŸçš„ä¼šè¯ã€‚å¯ä»¥æƒ³è±¡ï¼Œä½¿ç”¨è®¿é—®ä»¤ç‰Œå’Œåˆ·æ–°ä»¤ç‰Œå¯ä»¥è½»æ¾å®ç°ã€‚å½“ç”¨æˆ·æ‰§è¡Œæ“ä½œæ—¶ï¼Œå°†å‘å‡ºæ–°çš„è®¿é—®ä»¤ç‰Œã€‚å¦‚æœç”¨æˆ·ä½¿ç”¨è¿‡æœŸçš„è®¿é—®ä»¤ç‰Œï¼Œåˆ™è¯¥ä¼šè¯å°†è¢«è§†ä¸ºéæ´»åŠ¨çŠ¶æ€ï¼Œå¹¶ä¸”éœ€è¦æ–°çš„è®¿é—®ä»¤ç‰Œã€‚æ˜¯å¦å¯ä»¥ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œè·å–æ­¤ä»¤ç‰Œæˆ–è€…éœ€è¦æ–°çš„èº«ä»½éªŒè¯è½®æ¬¡æ˜¯ç”±å¼€å‘å›¢é˜Ÿçš„è¦æ±‚å®šä¹‰çš„ã€‚")]),t._v(" "),a("p",[t._v("ä¸Šæ–‡æ‘˜æŠ„è‡ª "),a("a",{attrs:{href:"https://auth0.com/blog/refresh-tokens-what-are-they-and-when-to-use-them/",target:"_blank",rel:"noopener noreferrer"}},[t._v("åˆ·æ–°ä»¤ç‰Œï¼šä½•æ—¶ä½¿ç”¨å®ƒä»¬ä»¥åŠå®ƒä»¬å¦‚ä½•ä¸ JWT äº¤äº’"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"åºŸè¯ä¸€å †-ç®€å•çš„æ¥è¯´å°±æ˜¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åºŸè¯ä¸€å †-ç®€å•çš„æ¥è¯´å°±æ˜¯"}},[t._v("#")]),t._v(" "),a("strong",[t._v("åºŸè¯ä¸€å †ï¼Œç®€å•çš„æ¥è¯´å°±æ˜¯ï¼š")])]),t._v(" "),a("blockquote",[a("p",[t._v("æœåŠ¡å™¨ç”Ÿæˆ token çš„è¿‡ç¨‹ä¸­ï¼Œä¼šæœ‰ä¸¤ä¸ªæ—¶é—´ï¼Œä¸€ä¸ªæ˜¯ token å¤±æ•ˆæ—¶é—´ï¼Œä¸€ä¸ªæ˜¯ token åˆ·æ–°æ—¶é—´ï¼Œåˆ·æ–°æ—¶é—´è‚¯å®šæ¯”å¤±æ•ˆæ—¶é—´é•¿ï¼Œå½“ç”¨æˆ·çš„ "),a("code",[t._v("token")]),t._v(" è¿‡æœŸæ—¶ï¼Œä½ å¯ä»¥æ‹¿ç€è¿‡æœŸçš„ token å»æ¢å–æ–°çš„ tokenï¼Œæ¥ä¿æŒç”¨æˆ·çš„ç™»é™†çŠ¶æ€ï¼Œå½“ç„¶ä½ è¿™ä¸ªè¿‡æœŸ token çš„è¿‡æœŸæ—¶é—´å¿…é¡»åœ¨åˆ·æ–°æ—¶é—´ä¹‹å†…ï¼Œå¦‚æœè¶…å‡ºäº†åˆ·æ–°æ—¶é—´ï¼Œé‚£ä¹ˆè¿”å›çš„ä¾æ—§æ˜¯ 401")])]),t._v(" "),a("p",[t._v("æ‰€ä»¥è¦å®ç°æ— ç—›åˆ·æ–° tokenï¼Œæˆ‘ä»¬åº”è¯¥è¿™æ ·")]),t._v(" "),a("ol",[a("li",[t._v("åœ¨ axios çš„æ‹¦æˆªå™¨ä¸­åŠ å…¥ token åˆ·æ–°é€»è¾‘")]),t._v(" "),a("li",[t._v("å½“ç”¨æˆ· token è¿‡æœŸæ—¶ï¼Œå»å‘æœåŠ¡å™¨è¯·æ±‚æ–°çš„ token")]),t._v(" "),a("li",[t._v("æŠŠæ—§çš„ token æ›¿æ¢ä¸ºæ–°çš„ token")]),t._v(" "),a("li",[t._v("ç„¶åç»§ç»­ç”¨æˆ·å½“å‰çš„è¯·æ±‚")]),t._v(" "),a("li",[t._v("ç”¨æˆ·ä½“éªŒæ£’æ£’å“’ ğŸ’¯")])]),t._v(" "),a("h2",{attrs:{id:"ä¸Šä»£ç "}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸Šä»£ç "}},[t._v("#")]),t._v(" ä¸Šä»£ç ")]),t._v(" "),a("p",[t._v("åœ¨ axios çš„æ‹¦æˆªå™¨ä¸­åŠ å…¥ token åˆ·æ–°é€»è¾‘")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("interceptors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("response")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯¹å“åº”æ•°æ®åšç‚¹ä»€ä¹ˆ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("401")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœå½“å‰è·¯ç”±ä¸æ˜¯loginï¼Œå¹¶ä¸”ç”¨æˆ·æœ‰ â€œè®°ä½å¯†ç â€ çš„æ“ä½œ")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é‚£ä¹ˆå»è¯·æ±‚æ–° token")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("currentRoute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"login"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRemember")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRefreshToken")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            Message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ç™»é™†è¿‡æœŸè¯·é‡æ–°ç™»é™†ï¼"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setToken")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"login"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯¹å“åº”é”™è¯¯åšç‚¹ä»€ä¹ˆ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br")])]),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"refreshToken"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// refreshToken ä¸­é‡æ–°è®¾ç½®äº† token å’Œ  refresh_token")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("commit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"setToken"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" expiresIn "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRefreshToken")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" refreshTtl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("h3",{attrs:{id:"æ¥çœ‹æµ‹è¯•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ¥çœ‹æµ‹è¯•"}},[t._v("#")]),t._v(" æ¥çœ‹æµ‹è¯•")]),t._v(" "),a("blockquote",[a("p",[t._v("ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œæˆ‘ä»¬æ‰‹åŠ¨æ¸…é™¤äº† token æ¥é€ æˆ token è¿‡æœŸçš„æ•ˆæœ")])]),t._v(" "),a("p",[a("img",{attrs:{src:n(597),alt:"2018_12_08_M3OBbekLBh.gif"}})]),t._v(" "),a("p",[t._v("å¯ä»¥çœ‹åˆ°æ‰‹åŠ¨æ¸…é™¤ token ä¹‹åï¼Œç³»ç»Ÿè‡ªåŠ¨å» refresh äº† tokenï¼Œè€Œä¸æ˜¯è·³åˆ°ç™»å½•é¡µé¢")]),t._v(" "),a("h2",{attrs:{id:"ä½†æ˜¯é—®é¢˜åˆæ¥äº†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä½†æ˜¯é—®é¢˜åˆæ¥äº†"}},[t._v("#")]),t._v(" ä½†æ˜¯é—®é¢˜åˆæ¥äº†")]),t._v(" "),a("blockquote",[a("p",[t._v("å¯ä»¥çœ‹å‡ºç”¨æˆ·æœ¬èº«è¦å»è¯·æ±‚ articles çš„æ¥å£ï¼Œå¹¶æ²¡æœ‰å†é‡å¤è¯·æ±‚ã€‚è¯·è„‘è¡¥ï¼šç”¨æˆ·ç‚¹å‡»äº†æ–‡ç« åˆ—è¡¨ï¼Œä½†æ˜¯ç³»ç»Ÿå¥½åƒ â€œæ²¡ååº”â€ ï¼Ÿï¼Ÿï¼Ÿ")])]),t._v(" "),a("p",[t._v("æ‰€ä»¥æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸ä»…è¦åˆ·æ–° token è€Œä¸”è¦å†æ¬¡å‘é€ç”¨æˆ·ä¸Šæ¬¡çš„è¯·æ±‚")]),t._v(" "),a("p",[t._v("ä¸Šä»£ç  ğŸ˜¼")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"refreshToken"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("token_type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" tokenType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("access_token")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" accessToken "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tokenType "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" accessToken"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" config "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Authorization "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" axios"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("p",[t._v("è¿™é‡Œæˆ‘ä»¬ä¸€å®šè¦ç”¨åŒæ­¥çš„æ–¹æ³•æ¥è¿›è¡Œè¿™ä¸€ç³»åˆ—æ“ä½œï¼ï¼ï¼ˆæ¯”å¦‚ async / awaitï¼‰")]),t._v(" "),a("p",[t._v("æ¥çœ‹æ¼”ç¤º ğŸ‘‡")]),t._v(" "),a("p",[a("img",{attrs:{src:n(598),alt:"2018_12_08_j6oBFSpwW5.gif"}})]),t._v(" "),a("h2",{attrs:{id:"åˆ°æ­¤å°±ç»“æŸäº†-ç›¸ä¿¡å¤§ä½¬ä»¬ä¸€å®šéƒ½æ‡‚äº†å§-ğŸ‘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆ°æ­¤å°±ç»“æŸäº†-ç›¸ä¿¡å¤§ä½¬ä»¬ä¸€å®šéƒ½æ‡‚äº†å§-ğŸ‘"}},[t._v("#")]),t._v(" åˆ°æ­¤å°±ç»“æŸäº†ï¼Œç›¸ä¿¡å¤§ä½¬ä»¬ä¸€å®šéƒ½æ‡‚äº†å§ ğŸ‘")])])}),[],!1,null,null,null);s.default=e.exports}}]);