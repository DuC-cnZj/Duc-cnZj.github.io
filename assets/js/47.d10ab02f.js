(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{736:function(s,n,t){s.exports=t.p+"assets/img/2020_06_07_LRpcFXzFLu.a6ed8311.png"},860:function(s,n,t){"use strict";t.r(n);var a=t(6),e=Object(a.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("blockquote",[a("p",[s._v("è½¬è‡ª https://xargin.com/addr-of-empty-struct-may-not-eq/")])]),s._v(" "),a("p",[s._v("https://www.zhihu.com/question/364687707")]),s._v(" "),a("p",[s._v("åœ¨çŸ¥ä¹ä¸Šå·²ç»è¯´äº†åŸå› ï¼Œä¸è¿‡åªæ˜¯è®²å®˜æ–¹çš„ specï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹å®ç°ä¸Šå…·ä½“ä¸ºä»€ä¹ˆä¼šæ˜¯è¿™æ ·çš„ã€‚")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('package main\n\nimport "fmt"\n\nfunc main() {\n\ta := new(struct{})\n\tb := new(struct{})\n\tprintln(a, b, a == b)\n\n\tc := new(struct{})\n\td := new(struct{})\n\tfmt.Println(c, d, c == d)\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("ç»“æœå¯èƒ½è®©ä½ å¾ˆæƒŠè®¶ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("0xc00007af1f 0xc00007af1f false\n&{} &{} true\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("å¦‚æœä¹‹å‰ç¢°åˆ°è¿‡ç»™ç¨‹åºåŠ ä¸Š fmt.Println å°±å¯¼è‡´ç»“æœå˜åŒ–çš„æƒ…å†µçš„åŒå­¦ï¼Œå¯èƒ½ä¼šæƒ³åˆ°è¿™é‡Œçš„åŸå› ï¼Œæ˜¯å’Œé€ƒé€¸åˆ†æç›¸å…³ã€‚(å¯ä»¥å‚è€ƒè¿™ä¸¤ä¸ª issue ï¼š"),a("a",{attrs:{href:"https://github.com/golang/go/issues/8618",target:"_blank",rel:"noopener noreferrer"}},[s._v("8618"),a("OutboundLink")],1),s._v(" å’Œ "),a("a",{attrs:{href:"https://github.com/golang/go/issues/31317",target:"_blank",rel:"noopener noreferrer"}},[s._v("31317"),a("OutboundLink")],1),s._v(")")]),s._v(" "),a("p",[s._v("æ²¡é”™ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('~/test git:master â¯â¯â¯ cat -n true.go                                                                              âœ± â—¼\n     1\tpackage main\n     2\n     3\timport "fmt"\n     4\n     5\tfunc main() {\n     6\t\ta := new(struct{})\n     7\t\tb := new(struct{})\n     8\t\tprintln(a, b, a == b)\n     9\n    10\t\tc := new(struct{})\n    11\t\td := new(struct{})\n    12\t\tfmt.Println(c, d, c == d)\n    13\t}\n~/test git:master â¯â¯â¯ go run -gcflags="-m" true.go                           \n\n# command-line-arguments\n./true.go:12:13: inlining call to fmt.Println\n./true.go:6:10: main new(struct {}) does not escape\n./true.go:7:10: main new(struct {}) does not escape\n./true.go:10:10: new(struct {}) escapes to heap\n./true.go:11:10: new(struct {}) escapes to heap\n./true.go:12:13: c escapes to heap\n./true.go:12:13: d escapes to heap\n./true.go:12:22: c == d escapes to heap\n./true.go:12:13: main []interface {} literal does not escape\n./true.go:12:13: io.Writer(os.Stdout) escapes to heap\n<autogenerated>:1: (*File).close .this does not escape\n0xc00007af1f 0xc00007af1f false\n&{} &{} true\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("p",[s._v("åœ¨ fmt.Println ä¸­å•ç‹¬å‡ºç°äº† cï¼Œæ‰€ä»¥ c = new çš„æ—¶å€™å°±å‘ç”Ÿäº†é€ƒé€¸ï¼Œd ä¹ŸåŒç†ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("æœªé€ƒé€¸ï¼šaï¼Œb")]),s._v(" "),a("li",[s._v("é€ƒé€¸ï¼šcï¼Œd")])]),s._v(" "),a("p",[s._v("çœ‹è¿‡ä¸€ç‚¹ go runtime ä»£ç çš„åŒå­¦åº”è¯¥çŸ¥é“ï¼Œåœ¨ runtime é‡Œæœ‰è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("// base address for all 0-byte allocations\nvar zerobase uintptr\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("0 å¤§å°çš„å†…å­˜åˆ†é…å‡ä¼šæŒ‡å‘è¯¥å˜é‡åœ°å€ï¼Œæ‰€è°“çš„ 0 å­—èŠ‚ï¼Œä¸»è¦å°±æ˜¯è¿™ç§ç©º structã€‚ä¸è¿‡è¿™é‡Œæ²¡è¯´æ¸…æ¥šçš„æ˜¯ï¼Œåªæœ‰åœ¨"),a("strong",[s._v("å †ä¸Š")]),s._v("åˆ†é…çš„ 0 å¤§å°çš„ struct æ‰ä¼šæŒ‡å‘è¯¥åœ°å€ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('package main\n\nimport "fmt"\n\nvar a = new(struct{}) // å †ä¸Š\n\nfunc main() {\n\tvar b = new(struct{})\n\tfmt.Println(b/*è¿™é‡Œå•ç‹¬æ‰“å°äº†ï¼Œæ‰€ä»¥ b escape åˆ°å †ä¸Š*/, a == b)\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("é‚£ä¹ˆç©º struct é€ƒé€¸ä¹‹åå…¶å®éƒ½æ˜¯åŒä¸€ä¸ªå˜é‡ï¼Œåœ°å€ç›¸ç­‰ï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥ç†è§£äº†ã€‚")]),s._v(" "),a("p",[s._v("æ²¡é€ƒé€¸çš„ a å’Œ b ä¸ºä»€ä¹ˆåœ°å€ä¸ç›¸ç­‰å‘¢ï¼Ÿè¿™é‡Œå¯ä»¥ç¥­å‡º SSA å¤§æ³•ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("~/test git:master â¯â¯â¯ sudo GOSSAFUNC=main go build true.go\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:t(736),alt:"2020_06_07_LRpcFXzFLu.png"}})]),s._v(" "),a("p",[s._v("å¯ä»¥çœ‹åˆ°è¿™ä¸ª falseï¼Œå…¶å®æ˜¯åœ¨ä»£ç ä¼˜åŒ–é˜¶æ®µ(opt)ç›´æ¥è¢«ç¼–è¯‘åç«¯ä½œä¸ºå¸¸é‡ä¼˜åŒ–æ‰äº†ï¼Œç›´æ¥è½¬æˆäº† falseã€‚")]),s._v(" "),a("p",[s._v("æ‰€ä»¥æˆ‘ä»¬æœ¬èƒ½åœ°ä»¥ä¸º == æ˜¯åœ¨åšæŒ‡é’ˆæ¯”è¾ƒï¼Œä½†æ˜¯å¸¸é‡ä¼˜åŒ–ä¼šæ›¿æˆ‘ä»¬åšå‡ºä¸é‚£ä¹ˆç¬¦åˆç›´è§‰çš„åˆ¤æ–­ï¼Œç›´æ¥æŠŠ a == b rewrite ä¸º falseã€‚")]),s._v(" "),a("p",[s._v("é—®é¢˜åˆ°è¿™é‡Œä¹Ÿå°±ç»“æŸäº†ï¼Œæ—¢ç„¶æˆ‘ä»¬çŸ¥é“è¿™é‡Œæ˜¯ä¼˜åŒ–é˜¶æ®µåšçš„ï¼Œé‚£æ˜¯ä¸æ˜¯æˆ‘ä»¬æŠŠä¼˜åŒ–å…³é—­å°±ä¼šå¯¼è‡´è¾“å‡º true å‘¢ï¼Ÿ")]),s._v(" "),a("p",[s._v("ç¡®å®æ˜¯çš„ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('~/test git:master â¯â¯â¯ cat true.go                                             \n\npackage main\n\nimport "fmt"\n\nfunc main() {\n\ta := new(struct{})\n\tb := new(struct{})\n\tprintln(a, b, a == b)\n\n\tc := new(struct{})\n\td := new(struct{})\n\tfmt.Println(c, d, c == d)\n}\n\n~/test git:master â¯â¯â¯ go run -gcflags="-N -l" true.go \n\n0xc00007aece 0xc00007aece true\n&{} &{} true\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[s._v("PSï¼šå†™è¿™ä¸ªåªæ˜¯å›¾ä¸ªä¹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Go é™„å¸¦çš„ SSA å·¥å…·å»æ›´æ·±å…¥åœ°è®¤è¯†æ•´ä¸ªç¼–è¯‘é˜¶æ®µå¹²çš„äº‹æƒ…ï¼Œä»è€Œç†è§£å®˜æ–¹çš„æ‰€è°“â€œå®ç°ç»†èŠ‚â€å’Œ spec ä¸Šçš„ may or may not åˆ°åº•æ˜¯æ€ä¹ˆå›äº‹ã€‚")]),s._v(" "),a("p",[a("strong",[s._v("è¦æ˜¯å“ªä½å·¥ç¨‹å¸ˆæ‹¿è¿™ä¸ªå»åšé¢è¯•é¢˜ï¼Œé‚£å°±å¤ªç¼ºå¾·å•¦ï¼")]),s._v("(çœŸå®ğŸ¤£)")])])}),[],!1,null,null,null);n.default=e.exports}}]);